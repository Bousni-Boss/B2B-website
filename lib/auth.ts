import { cookies } from 'next/headers';import { findClientByUsername } from './data';export type Session={sub:string;name:string;username:string;role:'client'|'admin'|'superadmin'};const COOKIE='session';export async function login(username:string,password:string){const user=findClientByUsername(username||'');if(!user||user.password!==password)return null;const session:Session={sub:user.id,name:user.name,username:user.username,role:user.role??'client'};const value=Buffer.from(JSON.stringify(session)).toString('base64');cookies().set(COOKIE,value,{httpOnly:true,path:'/',sameSite:'lax'});return session;}export async function logout(){cookies().delete(COOKIE);}export async function getSessionFromCookie(){const c=cookies().get(COOKIE)?.value;if(!c)return null;try{const s=JSON.parse(Buffer.from(c,'base64').toString());return s;}catch{return null}}